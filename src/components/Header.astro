---
import ThemeToggle from './ThemeToggle.astro';

const navItems = [
  { href: '/', label: 'Home' },
  { href: '/now', label: 'Now' },
  { href: '/about', label: 'About' },
  { href: '/manual', label: 'Manual' },
  { href: '/music', label: 'Music' },
  { href: '/writing', label: 'Writing' },
  { href: '/tools', label: 'Tools' },
];

const currentPath = Astro.url.pathname;
---

<header class="sticky top-0 z-50 w-full border-b border-border bg-surface/80 backdrop-blur-md dark:border-border-dark dark:bg-surface-dark/80">
  <nav class="mx-auto flex h-16 max-w-5xl items-center justify-between px-4 sm:px-6">
    <a href="/" class="font-heading text-lg font-semibold tracking-tight">
      Rhyd Lewis
    </a>

    <div class="flex items-center gap-1 sm:gap-2">
      <ul class="hidden items-center gap-1 sm:flex">
        {navItems.map((item) => (
          <li>
            <a
              href={item.href}
              class:list={[
                'rounded-lg px-3 py-2 text-sm font-medium transition-colors',
                currentPath === item.href || (item.href !== '/' && currentPath.startsWith(item.href))
                  ? 'bg-muted text-text dark:bg-muted-dark dark:text-text-dark'
                  : 'text-text-muted hover:bg-muted hover:text-text dark:text-text-dark-muted dark:hover:bg-muted-dark dark:hover:text-text-dark',
              ]}
            >
              {item.label}
            </a>
          </li>
        ))}
      </ul>

      <ThemeToggle />

      <!-- Mobile menu button -->
      <button
        type="button"
        class="inline-flex items-center justify-center rounded-lg p-2 text-text-muted hover:bg-muted hover:text-text sm:hidden dark:text-text-dark-muted dark:hover:bg-muted-dark dark:hover:text-text-dark"
        aria-label="Open menu"
        id="mobile-menu-button"
      >
        <svg class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5" />
        </svg>
      </button>
    </div>
  </nav>

  <!-- Mobile menu -->
  <div id="mobile-menu" class="hidden border-t border-border px-4 py-3 sm:hidden dark:border-border-dark">
    <ul class="space-y-1">
      {navItems.map((item) => (
        <li>
          <a
            href={item.href}
            class:list={[
              'block rounded-lg px-3 py-2 text-sm font-medium transition-colors',
              currentPath === item.href || (item.href !== '/' && currentPath.startsWith(item.href))
                ? 'bg-muted text-text dark:bg-muted-dark dark:text-text-dark'
                : 'text-text-muted hover:bg-muted hover:text-text dark:text-text-dark-muted dark:hover:bg-muted-dark dark:hover:text-text-dark',
            ]}
          >
            {item.label}
          </a>
        </li>
      ))}
    </ul>
  </div>
</header>

<script>
  const menuButton = document.getElementById('mobile-menu-button');
  const mobileMenu = document.getElementById('mobile-menu');

  menuButton?.addEventListener('click', () => {
    mobileMenu?.classList.toggle('hidden');
  });
</script>
